deploy azure functions via powershell
az login
cd packages/azure-functions
func azure functionapp publish PadelCommunity

deploy database scripts
change password in supabase/.env
set SUPABASE_DB_PASSWORD= ENQWwjpCnBhquhcm -- dev
set SUPABASE_DB_PASSWORD= fRxBLWcZHFVKm8Vu -- prd
change .env files to prd file in frontend
ask claude to run migration to supabase
problemen door oa
Great! The connection worked with aws-1-eu-west-1 instead of aws-0-eu-west-1!
dev
npx supabase db push --db-url "postgresql://postgres.djnljqrarilsuodmetdl:u4QzjDHiKfuQqDHX@aws-1-eu-west-1.pooler.supabase.com:6543/postgres"

region kan je vinden in project overview
prd 
npx supabase db push --db-url "postgresql://postgres.avwrplietxyrdqevpayb:TV4P1mTOAnXYd0Ll@aws-1-eu-north-1.pooler.supabase.com:6543/postgres"

prd

run front end locally
cd C:\PadelCommunity\packages\frontend
npm run dev
somns gaat die automatisch naar poort 8083 als hij herstart 
   free up port 8083
   free up port 8082

run azure-functions locally?
cd c:\PadelCommunity\packages\azure-functions && func start


----------- direct token refresh ------------------------------
In client.ts, in de directTokenRefresh() functie:

De await supabase.auth.setSession() call hangt. Verander dit naar fire-and-forget (ZONDER await) omdat localStorage al geÃ¼pdatet is en customFetch daar direct uit leest.

Verander van:

try {
  await supabase.auth.setSession({
    access_token: data.access_token,
    refresh_token: data.refresh_token,
  });
} catch (err) {
  console.warn('[directTokenRefresh] setSession sync failed, continuing:', err);
}

Naar:

// Fire-and-forget: don't await because setSession can hang
// localStorage is already updated, and customFetch reads from there
supabase.auth.setSession({
  access_token: data.access_token,
  refresh_token: data.refresh_token,
}).catch(err => {
  console.warn('[directTokenRefresh] setSession sync failed (non-blocking):', err);
});


------ supabase client niet direct callen in write funcions --------------------------
In alle bestanden in lib/ en hooks/useMessages.ts:

1. Update de import:
   import { supabase } from "@/integrations/supabase/client"
   â†’
   import { supabase, getDataClient } from "@/integrations/supabase/client"

2. Vervang alle data operaties:
   await supabase.from(...)
   â†’
   await getDataClient().from(...)

   await supabase.rpc(...)
   â†’
   await getDataClient().rpc(...)

NIET vervangen:
- supabase.auth.* (auth operaties)
- supabase.channel(...) (realtime subscriptions)
- supabase.storage.* (file uploads)


--------------- volgorde ------------------------------------
### ðŸ“‹ Voor Claude Code:
```
In client.ts, update de customFetch functie:

Voeg VOOR het ophalen van de token een check toe:
1. Haal de URL op en check of het een auth request is
2. Als het GEEN auth request is, check getTokenExpirySeconds()
3. Als token verloopt binnen 60 seconden, roep directTokenRefresh() aan
4. PAS DAARNA haal de token op met getAccessTokenFromStorage()